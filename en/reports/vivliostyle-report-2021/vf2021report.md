---
title: "Activity Report for FY2021"
lang: en
---



## **Chapter 1: Financial Report for FY2021**

### Foreword

The structure has been changed from the annual report for this fiscal year, with the first section reporting the financial results in comparison with the past, and the second section reporting the activities based on that report.

### Balance Sheet for FY2021

The following table shows the status of assets held (balance sheet) as of the end of the current period (March 31, 2022). The figures are in yen.

| Title           | **This FY (2021)**    | **Prev. FY (2020)**    | **Increase/Decrease**     |
| ------------ | ---------- | ---------- | ---------- |
| **Ⅰ. Assets**   |            |            |            |
| 1. Current assets |            |            |            |
| Cash and deposits |   1,180,342  | 345,708     | 834,634    |
| Other current assets |   1,058,750  |      | 1,058,750    |
| Total current assets |   2,239,092  | 345,708     | 1,893,384    |
| 2 Fixed Assets |            |            |            |
| (1) Other fixed assets |            |            |            |
| Founding expenses | 113,050    | 113,050    | 0          |
| Total other fixed assets | 113,050    | 113,050    | 0          |
| Total fixed assets | 113,050    | 113,050    | 0          |
| Total assets | 2,352,142    | 458,758    | 1,893,384    |
| **Ⅱ. Liabilities**   |            |            |            |
| 1. Current liabilities |            |            |            |
| Withholdings | 31,139     | 31,139     | 0    |
| Loan from officer | 4,806,561  | 3,806,561  | 1,000,000  |
| Accounts payable |  11,000  |            |  11,000 |
| Accrued income taxes |  20,000 |            | 20,000  |
| Total current liabilities | 4,868,700 | 3,837,700 | 1,031,000 |
| Total liabilities | 4,868,700 | 3,837,700 | 1,031,000 |
| **Ⅲ. Net Assets** |            |            |            |
| 1. General Net Assets | -2,516,558 | -3,378,942 | 862,384 |
| Total net assets | -2,516,558 | -3,378,942 | 862,384 |
| Total liabilities and net assets | 2,352,142    | 458,758    | 1,893,384    |

Assets that can be recovered within one year are called current assets. Total current assets for the current period were 2,239,092 yen, up 1,893,384 yen from the previous period, and total assets, including fixed assets held for longer than one year, were 2,352,142 yen, also up 1,893,384 yen (the amount of fixed assets has not changed since the company was founded).

Total liabilities, on the other hand, increased by 1,031,000 yen from last year to 4,868,700 yen. Total net assets, which are total assets minus total liabilities, increased by 862,384 yen from the previous year to -2,516,558 yen. Graph below shows the main indicators on the balance sheet from the first fiscal year (Figure 1). It is striking that total net assets, which had been on a downward trend since its establishment, was able to turn upward in the current term, although still negative.

![Figure 1: Changes in Main Indicators in the Balance Sheet since Foundation](./img/fig-1.png){ width=100% }

### Net Assets Increase/Decrease Statement for FY2021

Next, let's look at the statement of changes in net assets, which shows the details of money spent and sales during the current period (April 1, 2020 to March 31, 2021). This is also in yen.

| Title                | **This FY (2021)** | **Prev. FY (2020)** | **Increase/Decrease** |
| ----------------- | ---------- | ---------- | ---------- |
| **I. General Net Assets Increase/Decrease** |            |            |            |
| 1. Ordinary Increase/Decrease |            |            |            |
| ⑴ Ordinary revenues  |            |            |            |
| ① Business income | ( 6,267,250) | (1,503,721)  | (4,763,529)  |
| Business income | 6,267,250  |  1,503,721  | 4,763,529  |
| ② Donation received | (116,546)  |  (61,209) | (55,337)     |
| Donation received  | 116,546  |  61,209 | 55,337     |
| ③ Other revenues | (6)          | (4)          | (2)          |
| Interest received   | 6          | 4          | 2          |
| Total ordinary revenues | 6,383,802   | 1,564,934  | 4,818,868  |
| ⑵ Ordinary expenses |            |            |            |
| ① Business expenses |            |            |            |
| Business expenses | (325,918)    | (373,823)     | (-47,905)    |
| Travel and transportation expenses |      | 11,527   | -11,527  |
| Communication transportation costs | 940    |   252   | 688        |
| Consumables costs | 22,000    |     | 22,000        |
| Miscellaneous expenses |      |  39,064  | -39,064     |
| Commission fee  | 97,624     | 65,575     | 32,049     |
| Compensation paid | 198,000    |   257,405 | -59,405    |
| Newspaper book expenses | 7,354   |    | 7,354    |
| Total business expenses  | 325,918    | 373,823    | -47,905    |
| ② Administrative expenses  |            |            |            |
| Outsourcing costs  | 5,175,500  | 3,454,000    | 1,721,500  |
| Meeting fee  |       |  2,623 | -2,623      |
| Total administrative expenses | 5,175,500  | 3,456,623    | 1,718,877  |
| Total ordinary expenses  | 5,501,418  | 3,830,446  | 1,670,972  |
| Ordinary increase/decrease before valuation gain/loss this FY | 882,384 | -2,265,512 | 3,147,896 |
| Total valuation gain/loss | 0          | 0          | 0          |
| Ordinary increase/decrease this FY | 882,384 | -2,265,512 | 3,147,896 |
| 2. Non-ordinary Increase/Decrease |            |            |            |
| ⑴ Non-ordinary revenues |            |            |            |
| Total non-ordinary revenues | 0          | 0          | 0          |
| ⑵ Non-ordinary expenses |            |            |            |
| Total non-ordinary expenses | 0          | 0          | 0          |
| Non-ordinary increase/decrease this FY | 0          | 0          | 0          |
| General net assets increase/decrease before transfer to other accounts this FY | 882,384 | -2,265,512 | 3,147,896 |
| General net assets increase/decrease before taxes this FY | 882,384 | -2,265,512 | 3,147,896 |
| Corporate tax, resident tax and business tax | 20,000     | 20,000     | 0    |
| General net assets increase/decrease this FY | 862,384 | -2,285,512 | 3,147,896 |
| General net assets at beginning of FY | -3,378,942 | -1,093,430  | -2,285,512 |
| General net assets at end of FY | -2,516,558 | -3,378,942 | 862,384 |
| **II. Designated Net Assets Increase/Decrease** |            |            |            |
| Designated net assets increase/decrease this FY  | 0          | 0          | 0          |
| Designated net assets at beginning of FY | 0          | 0          | 0          |
| Designated net assets at end of FY  | 0          | 0          | 0          |
| **III. Net Assets at End of FY**   | -2,516,558 | -3,378,942 | 862,384 |

First, let's look at “I. General Net Assets”. The term “General net assets” here is the opposite of “Designated Net Assets”. While the latter is property that is designated for use and the corporation cannot decide how to use it, the former is the opposite, allowing the corporation to freely decide how to use it. Since our corporation has no “Designated net assets” as described below, we should be able to grasp the income and expenses for the fourth fiscal year by looking at this section.

Among the “I. General Net Assets Increase/Decrease” section, what catches the eye is that “Business income” raised 6,267,250 yen, which is 4,763,529 yen more than the previous fiscal year (pale yellow cell). As a result, the “Total ordinary revenues”, which indicates the profit earned in the main business, was able to raise 6,383,802 yen, which is 1,564,934 yen more than the previous year. This revenue amount is about four times that of the previous fiscal year. This was due to the expansion of contract development from external companies, which was also mentioned in the [Previous Business Report](https://vivliostyle.org/viewer/#src=https://vivliostyle.github.io/vivliostyle_doc/ja/reports/vivliostyle-report-2020/vf2020report.html&bookMode=true&f=epubcfi(/2!/4/84)) in the current fiscal year. In addition, although the amount is not a large amount, we were able to obtain 116,546 yen in “Donations received”, which is 55,337 yen more than the previous fiscal year.

On the other hand, “Total business expenses”, which are the expenses to conduct business, were 325,918 yen, 47,905 yen less than the previous fiscal year. “Total administrative expenses”, which are the costs of maintaining the corporation, totaled 5,175,500 yen, 1,718,877 yen more than in the previous fiscal year. This increase was due to the aforementioned “Outsourcing costs” (labor costs to subcontractors) related to the large increase in “Business income”. As already mentioned, in the previous fiscal year, “Business income” totaled 1,503,721 yen. The reason for the four-fold increase was due in part to the increase in the number of projects, but also to the fact that the company was able to subcontract work to developers other than Representative Director Murakami. Securing development resources will be the key to securing the same or higher business profits in the next fiscal year. “Total ordinary expenses”, which are the sum of the “Total business expenses”and “Total administrative expenses” mentioned above, totaled 5,501,418 yen, 1,670,972 yen more than the previous fiscal year.

Looking further down, “Total valuation gain/loss”, which shows the difference between the purchase price and the current price of assets held related to securities, etc., is 0 yen. This is because we do not hold any securities. “Total non-ordinary expenses”, which represent income other than core business, are also zero.

At the end of “I. General Net Assets Increase/Decrease” is “General net assets at beginning of FY” and “General net assets at end of FY”. To put it simply, the former is the money carried forward from the previous term, while the latter is the money carried forward to the next term. The former, that is, the “General net assets at beginning of FY” was -3,378,942, while the latter, that is, the “General net assets at end of FY” increased by 862,384 yen to -2,516,558. To put it simply, it shows that although the deficit up to the previous term has been reduced, there is still a long way to go to eliminate it.

The next section, “II. Designated Net Assets Increase/Decrease” are all zero yen, as mentioned above. And the carryover to the 5th period, “III. Net Assets at End of FY” was -2,516,558 yen (the same as “General net assets at end of FY”). Figure 2 shows a graphical representation of the changes in the main indicators on the statement of changes in net assets since the foundation of the company. The graph (Figure 2) shows that all indicators, except for “Business expenses”, have increased significantly.

![Figure 2: Changes in Key Indicators in the Net Assets Increase/Decrease Statement since Foundation](./img/fig-2.png){ width=100% }

Finally, “Ordinary increase/decrease this FY”, an indicator of whether a business is in the red or in the black, is shown graphically from its inception (Figure 3). It can be seen that the deficit amount had been increasing until the previous fiscal year, but this fiscal year it has been able to turn into a surplus (so-called single-year surplus) with a V-shaped recovery.

![Changes in “Ordinary increase/decrease this FY” since foundation](./img/fig-3.png){ width=100% }

### Income and Expenditure Statement for FY2021

At the end of Chapter 1, we will look at “Income and Expenditure Statement”, which compares the budgeted amount to the closing amount during the current fiscal year (April 1, 2020 to March 31, 2021). However, since we have not developed a budget, it will remain a formality and will be substantially the same as the statement of changes in net assets in the previous section. The unit of measure is also yen.

| Title   | Budgetary Amount | Settlement Amount | Difference | Note |
| ----------------- | --- | ---------- | ---------- | -- |
| **I. General Net Assets Increase/Decrease** |     |            |            |    |
| 1. Ordinary Increase/Decrease |     |            |            |    |
| ⑴ Ordinary revenues  |     |            |            |    |
| ① Business income  | (0)   | (6,267,250)  | -6,267,250 |    |
| Business income |     | 6,267,250  | -6,267,250 |    |
| ② Donation received  | (0)   |( 116,546)     | (-116,546)    |    |
| Donation received |     | 116,546     | -116,546   |    |
| ③ Other revenues | (0)   | (6)          | (-6)         |    |
| Interest received  |  0   | 6          | -6         |    |
| Total ordinary revenues | 0   | 6,383,802  | -6,383,802 |    |
| ⑵ Ordinary expenses  |     |            |            |    |
| ① Business expenses |     |            |            |    |
| Business expenses  | (0)   | (325,918)    | -325,918   |    |
| Travel and transportation expenses  |     | 940        | -940      |    |
| Communication transportation costs |     | 22,000     | -22,000    |    |
| Consumables costs |     | 97,624    | -97,624    |    |
| Compensation paid   |     | 198,000    | -198,000   |    |
| Newspaper book expenses |     | 7,354    | -7,354   |    |
| Total business expenses | 0   | 325,918    | -325,918   |    |
| ② Administrative expenses  |     |            |            |    |
| Outsourcing costs |     | 5,175,500  | -5,175,500 |    |
| Total administrative expenses | 0   | 5,175,500  | -5,175,500 |    |
| Total ordinary expenses | 0   | 5,501,418  | -5,501,418 |    |
| Ordinary increase/decrease before valuation gain/loss this FY | 0   | 882,384 |-882,384  |    |
| Total valuation gain/loss | 0   | 0          | 0          |    |
| Ordinary increase/decrease this FY | 0   | 882,384 | -882,384  |    |
| 2. Non-ordinary Increase/Decrease  |     |            |            |    |
| ⑴ Non-ordinary revenues |     |            |            |    |
| Total non-ordinary revenues  | 0   | 0          | 0          |    |
| ⑵ Non-ordinary expenses  |     |            |            |    |
| Total non-ordinary expenses | 0   | 0          | 0          |    |
| Non-ordinary increase/decrease this FY  | 0   | 0          | 0          |    |
| General net assets increase/decrease before transfer to other accounts this FY | 0   | 882,384 | -882,384  |    |
| General net assets increase/decrease before taxes this FY | 0   | 882,384 | -882,384  |    |
| Corporate tax, resident tax and business tax | 0   | 20,000     | -20,000    |    |
| General net assets increase/decrease this FY | 0   | 882,384 | -882,384  |    |
| General net assets at beginning of FY  | 0   | -3,378,942 | 3,378,942  |    |
| General net assets at end of FY  | 0   | -2,516,558 | 2,516,558  |    |
| **Ⅱ. Designated Net Assets Increase/Decrease** |     |            |            |    |
| II. Designated Net Assets Increase/Decrease | 0   | 0          | 0          |    |
| Designated net assets at beginning of FY  | 0   | 0          | 0          |    |
| Designated net assets at end of FY  | 0   | 0          | 0          |    |
| **III. Net Assets at End of FY**   | 0   | -2,516,558 | 2,516,558  |    |

## **Chapter 2: Activity Report for FY2021**

### はじめに

前章で述べたように、当法人は今期、単年度黒字を達成することができた。その直接の原因は、既述のように外部企業からの受託開発が拡大したからだ。しかし、背景にはVivliostyleプロダクトが充実したこと、そしてラインナップが整備されたことにより、プロダクト間のエコシステムが機能し始めたことがある。

言い換えれば、これらの要因なしに受託開発の拡大もなかったと考えられる。そこで本章ではVivliostyleプロダクトそれぞれの開発状況を説明する。さらに次期への課題はないかを探っていく。これも繰り返しになるが、当法人は決して少なくない累積赤字を抱えており、その解消が当面の目標となるからだ。

### プロダクトの分類とそれぞれの役目

今期の開発状況について報告する前に、簡単にプロダクトの位置づけを整理しておこう。近年プロダクトが増え、ラインナップが整ったのは喜ばしいが、それぞれがどのような役割を果たしているのか、全体の中でどのように位置づけられるのか、外側からは分かりづらくなっているからだ。

- **ライブラリ（アプリケーションに組み込まれる「共通部品」）**
    - [Vivliostyle.js（Vivliostyle Viewerを含む）](https://github.com/vivliostyle/vivliostyle.js)
    - [VFM (Vivliostyle Flavored Markdown)](https://github.com/vivliostyle/vfm)
    - [Themes](https://github.com/vivliostyle/themes)
- **ジェネレータ（Markdown+CSSをHTML+CSSに変換）**
    - [Vivliostyle CLI](https://github.com/vivliostyle/vivliostyle-cli)
    - [create-book](https://github.com/vivliostyle/create-book)
    - [vivliostyle-sitegen](https://github.com/vivliostyle/vivliostyle-sitegen)
- **Webアプリ（上記を統合したアプリケーション）**
    - [Vivliostyle Pub](https://github.com/vivliostyle/vivliostyle-pub)
- **Webコンテンツとその制作システム（Vivliostyleに関わるドキュメント・サイト）**
    - [vivliostyle.org](https://github.com/vivliostyle/vivliostyle.org)（[Webサイト本体](https://vivliostyle.org/ja/)）
    - [docs.vivliostyle.org](https://github.com/vivliostyle/docs.vivliostyle.org) （[各プロダクトのユーザーガイド](https://vivliostyle.org/ja/documents/)）
    - [docs-vivliostyle-pub](https://github.com/vivliostyle/docs-vivliostyle-pub) （[Vivliostyle Pubのユーザーガイド](https://vivliostyle.github.io/docs-vivliostyle-pub/#/ja/)）
    - [vivliostyle_doc](https://github.com/vivliostyle/vivliostyle_doc)（[サンプルページ](https://vivliostyle.org/ja/samples/)や[事業報告書](https://vivliostyle.org/ja/about-us/)）

上記のリンクは、それぞれのリポジトリへのものだ。つまり、上記分類はリポジトリの分類でもある。ただし、上記分類は必ずしも厳密なものではない。たとえばVFMはライブラリであると同時に、MarkdownをHTMLに変換するジェネレータの一面ももつ。

では次節以降、上記分類に従いながら今期における各プロダクトの開発状況を、ユーザーイベントでの発表やブログ記事などを参照しながら説明していこう。なお、参考のために期首時点と期末時点のバージョンをカッコ内に示した（プロダクトとしてのリリースの概念がないThemesとVivliostyle Pubを除く）。

### ライブラリ：Vivliostyle.js（v2.6.2→v2.14.4 ）

[Vivliostyle.js](https://github.com/vivliostyle/vivliostyle.js)は実際にCSS組版をおこなうソフトウェアであり、Vivliostyleプロダクトの中核的存在である。幸いなことに本プロダクトは、以下のように今期大幅な機能アップを果たすことができた。

- **組版機能の向上**
     - [イベント発表：Vivliostyle CoreにおけるCSS Paged Media の実装](https://www.youtube.com/watch?v=_y3YBHNN2Oc)（村上真雄）
     - [イベント発表：CSS text-spacingサポート等Vivliostyle.jsの進化と今後の開発予定](https://www.youtube.com/watch?v=2hvsMhTJai4)（村上真雄）
     - [ブログ：最近のVivliostyle.jsの進化について](https://vivliostyle.org/ja/blog/2021/10/12/recent-vivliostyle-js-updates/)（小形克宏）
     - [ブログ：行末処理が進化して多様な組版ができるように](https://vivliostyle.org/ja/blog/2022/02/08/Improved-of-line-end-handling-and-support-for-page-progression-direction-in-PDF/)（小形克宏）
- **HTMLの中でJavaScriptの実行が可能に**
     - [ブログ：Vivliostyleの組版でJavaScriptが使えるようになりました](https://vivliostyle.org/ja/blog/2022/01/24/JavaScript-can-now-be-used-in-typesetting-by-Vivliostyle/)（小形克宏）
- **Webフォントへの対応**
     - [イベント発表：Vivliostyle PubでWebフォントを使う](https://www.youtube.com/watch?v=Hz5_Wd7d5lw)（小形克宏）
     - [イベント発表：VivliostyleでWebフォントを使う 調査編](https://www.youtube.com/watch?v=czVRSsekLjc)（小形克宏）

では、これらの機能はどのようにして開発されたのか。当該リポジトリにおける月毎のプルリクエスト数をグラフ化し、前期と比較してみたのが下記のグラフだ（図4／自動処理は除外し、人間によるプルリクエストのみを対象にした。以下同）。

![図4 前期と比較したVivliostyle.jsリポジトリの月間プルリクエスト数](./img/fig-4.png){ width=100% }

前期も年間を通してコンスタントにプルリクエストを出していたが、今期はそれを上回る開発ペースであったことがわかる。前掲の機能アップも、こうした熱心な開発の結果として実現された。

ここで重要なことは、Vivliostyle.jsの機能アップが、これを組み込んだVivliostyle CLIやVivliostyle Pubにも波及し、直ちにこれらも新機能を実装していったことだ。まさにライブラリとしての本領が発揮された場面だった。

### ライブラリ：VFM（v1.0.0-alpha.17→v1.2.1）

書籍むけ組版に最適化したMarkdown方言である[VFM (Vivliostyle Flavored Markdown)](https://github.com/vivliostyle/vfm)は、今期v1をリリースすることができた。このv1は、きたるべきv2への準備という側面もある。

もともと本プロダクトは、Markdownへの変換エンジンとして[Remark](https://remark.js.org/)を採用していた。しかし、その新バージョンRemark 13には過去のバージョンと非互換な変更が多く含まれていることから、その実装は多大な作業量が予想された。

そこで、まずRemark 13なしに実装できる範囲の機能を備えたバージョンをv1としてリリースし、その後v2としてRemark 13への対応に取り組む方針を決めていた。詳細はメンテナーである[akabekobeko](https://github.com/akabekobeko)氏の発表を参照してほしい。

- [イベント発表：VFMの開発状況](https://speakerdeck.com/akabekobeko/vfm-dev-stat)（akabekobeko）

2021年7月21日にリリースされた[v1.0.2 ](https://github.com/vivliostyle/vfm/releases/tag/v1.0.2)が、このRemark 13なしに実現できる機能を実装したものだ。同じく詳細は下記を参照されたい。

- [イベント発表：VFM 1.0 リリースと今後の展望](https://www.youtube.com/watch?v=lF6Mb2DXJK0)（akabekobeko）

v1で解決されたIssue等の一覧は下記の通りだ。Vivliostyle.jsと同様、こうした機能アップは速やかにVivliostyle CLIをはじめとしたプロダクトに実装されている。

- [v1.x](https://github.com/vivliostyle/vfm/milestone/3?closed=1)

### ライブラリ：Themes

Vivliostyleプロダクトが共通して使えるスタイルファイルのライブラリーが[本プロダクト](https://github.com/vivliostyle/themes)だ。スタイルを定義した複数のThemeファイル群と、それらThemeを作成するためのツール群から成り立っている。

今期も複数回のマイナーアップデートをおこなった。しかし成果として取り上げるべきは、むしろ下記ユーザーガイドの公開だろう。

- [開発チュートリアル](https://vivliostyle.github.io/themes/#/ja/tutorial/step0.md)
- [運用ガイドライン](https://vivliostyle.github.io/themes/#/ja/official)


ユーザーは本プロダクトによって、Vivliostyleプロダクトを使う際に新しくスタイルを設定する手間が不要になり、より早く簡単に文書作成ができるようになる。しかし、そのためにはユーザーの需要に応じた多種多様なThemeの公開が必要となる。しかし、私たちだけで多くのThemeを作成・公開するのは現実的ではない。個々のユーザーが簡単に新しいThemeを作ることができ、また、それを気軽に公開してもらうようにしなくてはならない。そうすることでライブラリーとしての本プロダクトがより便利になり、それがさらに新しいTheme作成を促すと言った循環が成立するはずだ。

ところが現状は本プロダクトの認知度が低く、まだまだ目標への道のりは遠い。そこでメンテナーである[yamasy1549](https://github.com/yamasy1549)氏が考えたのが、まずThemeの使い方、作り方などを知ってもらうためのドキュメント整備だった。上記ユーザーガイドはその第一歩といえるものだ。より詳しくは下記を参照してほしい。

- [イベント発表：Themesのハンズオン](https://www.youtube.com/watch?v=auqefAA0Bx0)（yamasy1549）
- [イベント発表：Vivliostyle Theme 開発ガイドラインの公開](https://www.youtube.com/watch?v=NioXx9NFUZU)（yamasy1549）

### ジェネレータ：Vivliostyle CLI（v3.2.1→v4.8.2）

CLI（コマンドライン・インターフェイス）でMarkdownをHTMLに変換、出力できるのが[本プロダクト](https://github.com/vivliostyle/vivliostyle-cli)だ。まず月間プルリクエスト数を、前期と比較したグラフを見てほしい。前期ほどではないが、今期もコンスタントに開発が続けられたことが分かる（図5）。

![図5 前期と比較したVivliostyle CLIリポジトリの月間プルリクエスト数](./img/fig-5.png){ width=80% }

このような開発の結果、今期も本プロダクトはさまざまな機能アップを果たすことができた。中でも大きなものは、仮想環境下で実行できるDockerモードのサポートだろう（[v4.0.0](https://github.com/vivliostyle/vivliostyle-cli/releases/tag/v4.0.0)）。Dockerはプログラムの実行環境を仮想化してくれる。これにより、OSやブラウザ、Vivliostyle CLI本体をバージョンアップすることで、出力結果が変わってしまうトラブルから解放された。こうした冪等性／信頼性の確保は、実務でVivliostyle CLIを利用したいユーザーにとって不可欠なもののはずだ。

これ以外にもマイナーながらいくつもの機能が追加されている。ここでは本プロダクトのメンテナーである[spring-raining](https://github.com/spring-raining)氏が、第4期終了直後に開催されたユーザーイベント[「Vivliostyle ユーザーと開発者の集い 2021春」](https://vivliostyle.connpass.com/event/208401/)において、[「Vivliostyle CLI update - 2022 Spring」](https://www.youtube.com/watch?v=GMzLJ17MLOk)として発表したものに従いながら、v4.0.0以降のアップデート内容をまとめてみよう。

- 外部Webフォントサービスの利用等のために`--http`オプションを追加 [#234](https://github.com/vivliostyle/vivliostyle-cli/pull/234)
- プリインストール以外のビュアーを指定する`--viewer`オプションの追加 [#234](https://github.com/vivliostyle/vivliostyle-cli/pull/234)
- 出力するPDFのメタ情報をより詳細に改善 [#239](https://github.com/vivliostyle/vivliostyle-cli/pull/239)
- PDFの読み方向（右閉じ／左閉じ）が指定できるように [#240](https://github.com/vivliostyle/vivliostyle-cli/pull/240)
- CLIコマンドをAPI化し、JavaScriptから操作可能に [#243](https://github.com/vivliostyle/vivliostyle-cli/pull/243)
- 複数出版物の同時出力 [#268](https://github.com/vivliostyle/vivliostyle-cli/pull/268)
- Vivliostyle.config.jsのvfmオプションを、CLI内部でのVFM実行時にそのまま渡すことが可能に [#264](https://github.com/vivliostyle/vivliostyle-cli/pull/264)
- エラー出力をより読みやすく改善 [#264](https://github.com/vivliostyle/vivliostyle-cli/pull/264)

なお、spring-raining氏はこの時の発表で、本プロダクトの将来構想について以下のように述べている。次期への期待が膨らむ。

 - **エクスポート先の拡充**
     - EPUB/MOBI
     - 他のMarkdown方言
     - 各種小説投稿サイトのテキストフォーマット
 - **外部画像サービスとの連携による表紙の追加機能**

### ジェネレータ：create-book（v0.1.6→v0.5.1）

[本プロダクト](https://github.com/vivliostyle/create-book)は、Vivliostyle CLIの実行環境をインタラクティブに構築することができるソフトウェア、つまりインストーラーである。ただし、今期はメインテナンス的なアップデートが多く、大きな機能アップはなかった。

### ジェネレータ：vivliostyle-sitegen

[本プロダクト](https://github.com/vivliostyle/vivliostyle-sitegen)は、VFMを使った静的サイトジェネレーター（Static Site Generator）として構想されたもので、今期に入って新しく開発がスタートしたプロダクトだ。

もともとのきっかけは、秋のユーザーイベント（2021年11月14日開催の[CSS組版 Vivliostyle ユーザーと開発者の集い 2021秋](https://vivliostyle.connpass.com/event/227954/)）における自由討議のセッションで、せっかくVFMがv1をリリースするまで成長したのに、これを使ってVivliostyleのサイトや各種ドキュメントが書けないのは残念という声が出たことだった。それに応える形でVFMのメンテナーである[akabekobeko](https://github.com/akabekobeko)氏が手を挙げ、2022年1月から開発がはじまった。

現在、来期中のリリースを目指して開発がすすめられている。リリース後は [vivliostyle.org](https://github.com/vivliostyle/vivliostyle.org)をはじめとする、Vivliostyleに関わるユーザー向けドキュメント制作システムに実装していく予定だ。そうなれば、豊富な表現力をもつVFMを使ってVivliostyleに関する情報発信ができるようになる。こうして、ますますVivliostyleのエコシステムが広がることになるだろう。

### Webアプリ：Vivliostyle Pub

[本プロダクト](https://github.com/vivliostyle/vivliostyle-pub)は、ここまで述べてきたVivliostyle.js、VFM、Themes、Vivliostyle CLIをクラウド上にデプロイしたWebアプリだ。ユーザーがブラウザ上の左側画面でMarkdownを書けば、即座にCSS組版して左側画面にプレビュー表示する（図6）。

![図6 アルファ版を公開したVivliostyle Pub](./img/fig-6.png){ width=100% }

もともとは2019年度（前々期）において、開発資金確保を目的とした未踏アドバンスト事業への応募のために急遽立ち上げられた。コミッター達が一丸となった2ヵ月間の集中開発をへて、2020年5月にPoC（Proof of Concept、概念実証）まで完成させた（[前期事業報告書](https://vivliostyle.org/viewer/#src=https://vivliostyle.github.io/vivliostyle_doc/ja/reports/vivliostyle-report-2020/vf2020report.html&bookMode=true&userStyle=data:,/*%3Cviewer%3E*/%0A@page%20%7B%20size:%20A4;%20%7D%0A/*%3C/viewer%3E*/&f=epubcfi(/2!/4/32[%E3%83%97%E3%83%AD%E3%83%80%E3%82%AF%E3%83%88%E3%81%AE%E9%96%8B%E7%99%BA%E7%8A%B6%E6%B3%81]))参照）。

しかし、2020年6月に落選が決まった後、少しずつコミッターが去っていき、残った[takanakahiko](https://github.com/takanakahiko)氏だけがコツコツと開発を続けてくれていた。そうした状況を一変させたのが2021年11月、[AyumuTakai](https://github.com/AyumuTakai)氏の参入だった。ここで、本プロダクトの月間プルリクエスト数を前期と比較したグラフをご覧いただきたい（図7）。

![図7 前期と比較したVivliostyle Pubリポジトリの月間プルリクエスト数](./img/fig-7.png){ width=100% }

一見すると今期前半において前期よりも多くプルリクエストをだしている（これはtakanakahiko氏の仕事）ものの、AyumuTakai氏が加わった11月〜翌年2月に関しては、さほど前期と今期の違いはないように見える。そこで指標を変えて、月間コミット数を前期と比較したグラフを見てみよう（図8）。

![図8 前期と比較したVivliostyle Pubリポジトリの月間コミット数](./img/fig-8.svg){ width=100% }

青い線は前期の、緑の線は今期のデフォルトブランチに対するコミット数だ。この2つのラインを見る限り、前掲図7の月間プルリクエスト数と同様、11月〜翌年2月に関してはさほど開発は進んでないように見える。ところがグレイのラインに注目してほしい。これは今期のAyumuTakai氏による`prototype`ブランチでの月間コミット数を重ね合わせたものだ。前期4月〜5月のコミット数は4〜5人のチームで開発した結果なのだが、それを凌駕する数のコミットを、たった1人でしていることが分かる。ただし、その開発方法はいささか変則的と言えるものだった。

AyumuTakai氏は11月2日から`prototype`ブランチで開発を始めているが、2月に入るまでデフォルトブランチへのプルリクエストは出さず、ひたすら`prototype`ブランチで多くのコミットを積み上げている。もしかしたら、たくさんの改良を次々に加えていった結果、プルリクエストを出すタイミングを失ったのかもしれない。結局、`prototype`ブランチはそのままにして、2月3日に`pre_alpha`というブランチを新規作成し、ここからデフォルトブランチへのプルリクエストを1回だけ出している。

この結果、前掲図7で示したプルリクエスト数にはAyumuTakai氏の作業はほとんど現れなかったが、前掲図8においてprototypeブランチのコミット数を重ね合わせることで、彼の貢献が可視化できた。この時のプルリクエスト、[アルファ版準備 #142 ](https://github.com/vivliostyle/vivliostyle-pub/pull/142)の記録をみると、ここで追加されたユーザーインターフェースの変更や追加した機能のリストを見ることができる。どれも本プロダクトをごく普通に使うためには、必須の要素であったことが分かる（なお、AyumuTakai氏は本業多忙を理由に、3月いっぱいで開発から退いた。彼の貢献に心から感謝する）。

ここまで本プロダクトの開発を直接担当したAyumuTakai氏やtakanakahiko氏の貢献について述べた。しかし忘れてはいけないのは、前節まで説明したVivliostyle.js、VFM、Themes、そしてVivliostyle CLIのアップデートの成果を、本プロダクトはコンポーネントを入れ替えるだけで、そのまま取り込むことができたということだ。

たとえば、前掲図6を見るとWebフォントを表示しているが、これは本プロダクトではなく、Vivliostyle.jsのアップデートによって実現した機能だ。まさにエコシステムとしてのVivliostyleプロダクトの力を実感できよう。

このようにして、当初の目標よりもだいぶずれ込んだが、2022年4月23日開催の[CSS組版 Vivliostyle ユーザーと開発者の集い 2021秋](https://vivliostyle.connpass.com/event/227954/)で、本プロダクトのアルファ版公開を告知することができたのである。

### Webコンテンツとその制作システム

ここでは、下記のVivliostyleに関わるユーザー向けドキュメントと、その制作システムを一括して取り上げる。

1. [vivliostyle.org](https://github.com/vivliostyle/vivliostyle.org)（[Webサイト本体](https://vivliostyle.org/ja/)）
2. [docs.vivliostyle.org](https://github.com/vivliostyle/docs.vivliostyle.org) （[各プロダクトのユーザーガイド](https://vivliostyle.org/ja/documents/)）
3. [docs-vivliostyle-pub](https://github.com/vivliostyle/docs-vivliostyle-pub) （[Vivliostyle Pubのユーザーガイド](https://vivliostyle.github.io/docs-vivliostyle-pub/#/ja/)）
4. [vivliostyle_doc](https://github.com/vivliostyle/vivliostyle_doc)（[サンプルページ](https://vivliostyle.org/ja/samples/)や[事業報告書](https://vivliostyle.org/ja/about-us/)）

当法人にとって、もっとも身近な情報発信のツールは上記1におけるブログである。今期は以下の8本の記事を更新した。

- [2021/04/21 Vivliostyle の最新アップデート — CLI 改良と CSS Paged Media サポートの充実](https://vivliostyle.org/ja/blog/2021/04/21/vivliostyle-improved-css-paged-media-support/)
- [2021/04/23 「Vivliostyle ユーザーと開発者の集い 2021春」開催報告](https://vivliostyle.org/ja/blog/2021/04/23/meetup-2021-spring-report/)
- [2021/06/16 JEPAセミナーでVivliostyleについて報告](https://vivliostyle.org/ja/blog/2021/06/16/Presentation-at-JEPA-Seminar/)
- [2021/06/26 技術書典 11 出展 & 合同誌無料配布キャンペーンのお知らせ](https://vivliostyle.org/ja/blog/2021/06/26/make-books-with-vivliostyle-vol5/)
- [2021/07/02 2020年度事業報告書を公開します](https://vivliostyle.org/ja/blog/2021/07/02/New-FY2020-Report-Released/)
- [2021/10/12 最近のVivliostyle.jsの進化について](https://vivliostyle.org/ja/blog/2021/10/12/recent-vivliostyle-js-updates/)
- [2021/11/17 「Vivliostyle ユーザーと開発者の集い 2021秋」開催報告](https://vivliostyle.org/ja/blog/2021/11/17/meetup-2021-autumn-report/)
- [2022/01/24 Vivliostyleの組版でJavaScriptが使えるようになりました](https://vivliostyle.org/ja/blog/2022/01/24/JavaScript-can-now-be-used-in-typesetting-by-Vivliostyle/)
- [2022/02/08 行末処理が進化して多様な組版ができるように](https://vivliostyle.org/ja/blog/2022/02/08/Improved-of-line-end-handling-and-support-for-page-progression-direction-in-PDF/)

また、Themesの節で新しく追加したことに述べたユーザーガイドは、上記2のうちの一つだ。そして上記3も、Vivliostyle Pubのアルファ版公開に備えて、今期新しく追加したユーザーガイドだ。

いずれも執筆はMarkdownでおこなうが、それをHTMLに変換するコンバーターは、1は[Jekyll](http://jekyllrb-ja.github.io/)、2と3は[docute](https://github.com/egoist/docute)、4は[Pandoc](https://pandoc-doc-ja.readthedocs.io/ja/latest/users-guide.html)とバラバラであるという課題がある。この状況を改善し、さらにVFMの豊富な表現を使えるようにしようというのが、 [vivliostyle-sitegen](https://github.com/vivliostyle/vivliostyle-sitegen)であることは前述したとおりだ。


### 次期への課題とその対処

以上、今期におけるVivliostyleプロダクトの開発状況を説明した。創立当初、当法人のプロダクトは現在のVivliostyle Viewer／Vivliostyle.jsと、Vivliostyle CLIにつながるものだけであった。そこから毎年少しずつリポジトリを増やしていき、前節まで述べてきたようなプロダクト間のエコシステムが機能し始めるところまで辿り着いた。

前章において、今期に単年度黒字を達成したことを報告したが、事業収益のほとんどはVivliostyleプロダクトに関わる受託開発、あるいは過去に納品したプロダクトのメンテナンスにより得られたものだ。つまり当法人の場合、プロダクトの開発とその拡充が、ダイレクトに事業収益確保につながっている。

とはいえ、Vivliostyleプロダクトを拡充しさえすれば、そのまま事業収益が増えていく訳ではない。つまり増益のためにプロダクト拡充は、必要条件ではなく十分条件なのである。では増益を阻むものはなにか。以下のような課題を挙げたい。

1. 事業収益のほとんどが受託開発に限られていること
2. 受託開発を請け負う開発者が限られていること
3. 受託開発の発注先がほぼ1社に限られていること

上記1の対処として、受託開発以外の多様な収益の確保が必要だ。たとえばVivliostyle Pubを使った事業収益などが挙げられるだろう。また、第3期に[スポンサー募集ページ](https://vivliostyle.org/ja/sponsors/)を作った後、ほとんど働きかけをしていない寄付金の拡充も真剣に考えるべきだろう。

同じく2については、前章「2021年度正味財産増減計算書」で述べたように、今期は村上代表以外の受託者を確保できたところ、来期も引き続き受託者を確保できるかがカギとなる。たとえば、コミッターの皆さんに受託開発をお願いすることも検討するべきだ。加えて個々のコミッターの負担を減らすために、プロダクト全体でコミッターを増やす努力が求められるだろう。

最後に3については、発注先の多様化は当然として、あわせて前述1の対処がそのまま3への対処ともなるはずだ。

### 理事

- [村上真雄 (Shinyu Murakami)](https://github.com/MurakamiShinyu)〈代表理事、設立時社員〉
- [リボアル・フロリアン (Florian Rivoal)](https://github.com/frivoal)〈理事、設立時社員〉
- [ヨハネス・ウィルム (Johannes Wilm)](https://github.com/johanneswilm)〈理事、設立時社員〉
- [小形克宏 (Katsuhiro Ogata)](https://github.com/ogwata)〈理事、2020年1月21日より〉
